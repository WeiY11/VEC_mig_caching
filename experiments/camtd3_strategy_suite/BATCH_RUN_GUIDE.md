# ğŸ“¦ æ‰¹é‡è¿è¡Œå·¥å…·ä½¿ç”¨æŒ‡å—

**å·¥å…·**: `run_batch_experiments.py`  
**åŠŸèƒ½**: æ™ºèƒ½åŒ–æ‰¹é‡è¿è¡Œå‚æ•°æ•æ„Ÿæ€§åˆ†æå®éªŒ

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- âœ… **äº¤äº’å¼é€‰æ‹©** - å‹å¥½çš„èœå•ç•Œé¢
- âœ… **é¢„è®¾æ¨¡å¼** - quick/medium/fullä¸‰ç§æ¨¡å¼
- âœ… **æ™ºèƒ½åˆ†ç»„** - æŒ‰ä¼˜å…ˆçº§/æ–°å¢/å…¨éƒ¨åˆ†ç»„
- âœ… **è¿›åº¦æ˜¾ç¤º** - å®æ—¶æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€
- âœ… **ç»“æœæ±‡æ€»** - è‡ªåŠ¨ç”Ÿæˆè¿è¡ŒæŠ¥å‘Š
- âœ… **å¹¶è¡Œæ”¯æŒ** - å¤šGPUå¹¶è¡Œè¿è¡Œï¼ˆå¯é€‰ï¼‰
- âœ… **é”™è¯¯å¤„ç†** - è¶…æ—¶å’Œå¼‚å¸¸è‡ªåŠ¨å¤„ç†

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼1: äº¤äº’å¼æ¨¡å¼ï¼ˆæœ€ç®€å•ï¼‰â­

```bash
python experiments/camtd3_strategy_suite/run_batch_experiments.py
```

ä¼šå‡ºç°å‹å¥½çš„èœå•ï¼š
```
å¯ç”¨çš„å®éªŒ:
------------------------------------------------------------------------------
#    å®éªŒåç§°                  ä¼˜å…ˆçº§   é…ç½®æ•°   é¢„è®¡æ—¶é—´(100è½®)     æ ‡è®°
------------------------------------------------------------------------------
1    æ•°æ®å¤§å°å¯¹æ¯”              é«˜       5        1.5-2h            
2    è½¦è¾†æ•°é‡å¯¹æ¯”              é«˜       5        1.5-2h            
3    æœ¬åœ°èµ„æºå¯¹å¸è½½å½±å“        ä¸­       5        1.5-2h            
4    æœ¬åœ°èµ„æºå¯¹æˆæœ¬å½±å“        ä¸­       7        2-3h              
5    å¸¦å®½å¯¹æˆæœ¬å½±å“            ä¸­       7        2-3h              
6    è¾¹ç¼˜èŠ‚ç‚¹é…ç½®å¯¹æ¯”          é«˜       6        1.8-2.5h          â­NEW
7    ä»»åŠ¡åˆ°è¾¾ç‡å¯¹æ¯”            é«˜       6        1.8-2.5h          â­NEW
8    ç§»åŠ¨é€Ÿåº¦å¯¹æ¯”              é«˜       6        1.8-2.5h          â­NEW
------------------------------------------------------------------------------

é€‰æ‹©æ–¹å¼:
  1. è¾“å…¥å®éªŒç¼–å·ï¼ˆç”¨é€—å·åˆ†éš”ï¼Œå¦‚: 1,2,6ï¼‰
  2. è¾“å…¥ 'all' è¿è¡Œæ‰€æœ‰å®éªŒ
  3. è¾“å…¥ 'high' è¿è¡Œé«˜ä¼˜å…ˆçº§å®éªŒ
  4. è¾“å…¥ 'new' è¿è¡Œæ–°å¢å®éªŒ

è¯·é€‰æ‹©è¦è¿è¡Œçš„å®éªŒ: â–Š
```

ç„¶åé€‰æ‹©æ¨¡å¼ï¼š
```
è¿è¡Œæ¨¡å¼:
  quick: å¿«é€Ÿæµ‹è¯•ï¼ˆ10è½®ï¼Œçº¦10-20åˆ†é’Ÿ/å®éªŒï¼‰
  medium: ä¸­ç­‰æµ‹è¯•ï¼ˆ100è½®ï¼Œçº¦1.5-3å°æ—¶/å®éªŒï¼‰
  full: å®Œæ•´å®éªŒï¼ˆ500è½®ï¼Œçº¦7-15å°æ—¶/å®éªŒï¼‰

é€‰æ‹©è¿è¡Œæ¨¡å¼ (quick/medium/full): â–Š
```

### æ–¹å¼2: å‘½ä»¤è¡Œæ¨¡å¼ï¼ˆå¿«é€Ÿé«˜æ•ˆï¼‰

#### åœºæ™¯1: å¿«é€Ÿæµ‹è¯•æ‰€æœ‰å®éªŒ
```bash
python run_batch_experiments.py --mode quick --all
```

#### åœºæ™¯2: å®Œæ•´è¿è¡Œé«˜ä¼˜å…ˆçº§å®éªŒ
```bash
python run_batch_experiments.py --mode full --high-priority
```

#### åœºæ™¯3: æµ‹è¯•æ–°å¢çš„3ä¸ªå®éªŒ
```bash
python run_batch_experiments.py --mode medium --new-only
```

#### åœºæ™¯4: è¿è¡ŒæŒ‡å®šå®éªŒ
```bash
python run_batch_experiments.py --mode medium --experiments 1,2,6,7,8
```

#### åœºæ™¯5: å¹¶è¡Œè¿è¡Œï¼ˆå¤šGPUï¼‰
```bash
# æœ€å¤šåŒæ—¶è¿è¡Œ3ä¸ªå®éªŒ
python run_batch_experiments.py --mode medium --all --parallel 3
```

#### åœºæ™¯6: é™é»˜æ¨¡å¼ï¼ˆå‡å°‘è¾“å‡ºï¼‰
```bash
python run_batch_experiments.py --mode quick --all --silent
```

---

## ğŸ“‹ å‚æ•°è¯´æ˜

### è¿è¡Œæ¨¡å¼ (`--mode`)
| æ¨¡å¼ | è½®æ•° | å•å®éªŒæ—¶é—´ | é€‚ç”¨åœºæ™¯ |
|------|------|-----------|----------|
| `quick` | 10è½® | 10-20åˆ†é’Ÿ | å¿«é€ŸéªŒè¯æµç¨‹ |
| `medium` | 100è½® | 1.5-3å°æ—¶ | ä¸­ç­‰è´¨é‡æµ‹è¯• |
| `full` | 500è½® | 7-15å°æ—¶ | å®Œæ•´è®ºæ–‡å®éªŒ |

### å®éªŒé€‰æ‹©
| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--all` | è¿è¡Œæ‰€æœ‰8ä¸ªå®éªŒ | `--all` |
| `--high-priority` | ä»…é«˜ä¼˜å…ˆçº§(1,2,6,7,8) | `--high-priority` |
| `--new-only` | ä»…æ–°å¢å®éªŒ(6,7,8) | `--new-only` |
| `--experiments` | æŒ‡å®šå®éªŒç¼–å· | `--experiments 1,2,6` |

### å…¶ä»–å‚æ•°
| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--seed` | éšæœºç§å­ | 42 |
| `--suite-id` | ç»“æœæ ‡è¯†ç¬¦å‰ç¼€ | è‡ªåŠ¨ç”Ÿæˆ |
| `--parallel N` | å¹¶è¡Œè¿è¡ŒNä¸ªå®éªŒ | é¡ºåºè¿è¡Œ |
| `--silent` | é™é»˜æ¨¡å¼ | æ˜¾ç¤ºè¾“å‡º |

---

## ğŸ“Š è¿è¡Œç¤ºä¾‹

### ç¤ºä¾‹1: è®ºæ–‡å®Œæ•´å®éªŒï¼ˆæ¨èï¼‰

```bash
# è¿è¡Œé«˜ä¼˜å…ˆçº§çš„5ä¸ªå®éªŒï¼ˆå®Œæ•´æ¨¡å¼ï¼‰
# é¢„è®¡æ—¶é—´: 35-60å°æ—¶
python run_batch_experiments.py \
    --mode full \
    --high-priority \
    --seed 42 \
    --suite-id paper_final
```

### ç¤ºä¾‹2: å¿«é€Ÿå…¨é¢éªŒè¯

```bash
# å¿«é€Ÿæµ‹è¯•æ‰€æœ‰8ä¸ªå®éªŒ
# é¢„è®¡æ—¶é—´: 1.5-3å°æ—¶
python run_batch_experiments.py \
    --mode quick \
    --all \
    --suite-id quick_verify
```

### ç¤ºä¾‹3: æ–°å¢å®éªŒé‡ç‚¹æµ‹è¯•

```bash
# ä¸­ç­‰å¼ºåº¦æµ‹è¯•3ä¸ªæ–°å¢å®éªŒ
# é¢„è®¡æ—¶é—´: 5-8å°æ—¶
python run_batch_experiments.py \
    --mode medium \
    --new-only \
    --seed 42 \
    --suite-id new_experiments
```

### ç¤ºä¾‹4: å¹¶è¡ŒåŠ é€Ÿï¼ˆå¤šGPUï¼‰

```bash
# åœ¨3ä¸ªGPUä¸Šå¹¶è¡Œè¿è¡Œ
# æ—¶é—´å¯ç¼©çŸ­è‡³åŸæ¥çš„1/3
python run_batch_experiments.py \
    --mode medium \
    --all \
    --parallel 3 \
    --silent
```

---

## ğŸ“ˆ è¿è¡Œè¿‡ç¨‹

### é¡ºåºè¿è¡Œç¤ºä¾‹è¾“å‡º

```
======================================================================
                         å¼€å§‹é¡ºåºè¿è¡Œå®éªŒ
======================================================================

[1/5] è¿è¡Œå®éªŒ: æ•°æ®å¤§å°å¯¹æ¯”
  è„šæœ¬: run_data_size_comparison.py
  é…ç½®æ•°: 5, æ¯é…ç½®è½®æ•°: 100
  é¢„è®¡æ—¶é—´: 1.5-2h (åŸºäº100è½®)
----------------------------------------------------------------------
âœ“ å®Œæˆ! ç”¨æ—¶: 95.3 åˆ†é’Ÿ

[2/5] è¿è¡Œå®éªŒ: è½¦è¾†æ•°é‡å¯¹æ¯”
  è„šæœ¬: run_vehicle_count_comparison.py
  é…ç½®æ•°: 5, æ¯é…ç½®è½®æ•°: 100
  é¢„è®¡æ—¶é—´: 1.5-2h (åŸºäº100è½®)
----------------------------------------------------------------------
âœ“ å®Œæˆ! ç”¨æ—¶: 98.7 åˆ†é’Ÿ

...
```

### å®Œæˆåè‡ªåŠ¨æ˜¾ç¤ºæ‘˜è¦

```
======================================================================
                            è¿è¡Œæ‘˜è¦
======================================================================

Suite ID: batch_medium_20231029_123456
è¿è¡Œæ¨¡å¼: medium (100 è½®/é…ç½®)

æ€»å®éªŒæ•°: 5
  âœ“ æˆåŠŸ: 5
  
æ€»ç”¨æ—¶: 8.23 å°æ—¶ (494.0 åˆ†é’Ÿ)

è¯¦ç»†ç»“æœ:
--------------------------------------------------------------------------------
#    å®éªŒåç§°                     çŠ¶æ€       ç”¨æ—¶           
--------------------------------------------------------------------------------
1    æ•°æ®å¤§å°å¯¹æ¯”                 æˆåŠŸ       95.3 min       
2    è½¦è¾†æ•°é‡å¯¹æ¯”                 æˆåŠŸ       98.7 min       
6    è¾¹ç¼˜èŠ‚ç‚¹é…ç½®å¯¹æ¯”             æˆåŠŸ       102.1 min      
7    ä»»åŠ¡åˆ°è¾¾ç‡å¯¹æ¯”               æˆåŠŸ       99.5 min      
8    ç§»åŠ¨é€Ÿåº¦å¯¹æ¯”                 æˆåŠŸ       98.4 min      
--------------------------------------------------------------------------------

ç»“æœä½ç½®:
  results/parameter_sensitivity/batch_medium_20231029_123456_*/
  - summary.json (æ±‡æ€»æ•°æ®)
  - *.png (å¯¹æ¯”å›¾è¡¨)

æ‰¹é‡è¿è¡Œæ‘˜è¦å·²ä¿å­˜: results/parameter_sensitivity/batch_medium_20231029_123456_batch_summary.json
```

---

## ğŸ¯ æ¨èä½¿ç”¨ç­–ç•¥

### ç¬¬ä¸€æ¬¡ä½¿ç”¨

1. **å¿«é€ŸéªŒè¯**ï¼ˆ30åˆ†é’Ÿï¼‰
   ```bash
   python run_batch_experiments.py --mode quick --experiments 2
   # å…ˆæµ‹è¯•1ä¸ªå®éªŒï¼Œç¡®è®¤ç¯å¢ƒæ­£å¸¸
   ```

2. **æ–°å¢å®éªŒå¿«é€Ÿæµ‹è¯•**ï¼ˆ2å°æ—¶ï¼‰
   ```bash
   python run_batch_experiments.py --mode quick --new-only
   # æµ‹è¯•3ä¸ªæ–°å¢å®éªŒ
   ```

3. **å…¨é¢å¿«é€Ÿæµ‹è¯•**ï¼ˆ3å°æ—¶ï¼‰
   ```bash
   python run_batch_experiments.py --mode quick --all
   # æµ‹è¯•æ‰€æœ‰8ä¸ªå®éªŒ
   ```

### è®ºæ–‡å‡†å¤‡é˜¶æ®µ

1. **é«˜ä¼˜å…ˆçº§ä¸­ç­‰æµ‹è¯•**ï¼ˆ10-15å°æ—¶ï¼‰
   ```bash
   python run_batch_experiments.py --mode medium --high-priority
   # è¿è¡Œ5ä¸ªé«˜ä¼˜å…ˆçº§å®éªŒ
   ```

2. **å®Œæ•´å®éªŒ**ï¼ˆ50-70å°æ—¶ï¼‰
   ```bash
   # å»ºè®®åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ
   nohup python run_batch_experiments.py \
       --mode full \
       --all \
       --seed 42 \
       --suite-id paper_final_v1 \
       --silent > batch_run.log 2>&1 &
   ```

---

## ğŸ’¡ é«˜çº§æŠ€å·§

### 1. åå°è¿è¡Œï¼ˆLinux/Macï¼‰

```bash
# åå°è¿è¡Œå¹¶ä¿å­˜æ—¥å¿—
nohup python run_batch_experiments.py \
    --mode full --all --silent \
    > batch_run.log 2>&1 &

# æŸ¥çœ‹æ—¥å¿—
tail -f batch_run.log
```

### 2. Windowsåå°è¿è¡Œ

```powershell
# ä½¿ç”¨startå‘½ä»¤
start /B python run_batch_experiments.py --mode full --all --silent > batch_run.log 2>&1
```

### 3. åˆ†æ‰¹è¿è¡Œï¼ˆé¿å…å¤ªé•¿æ—¶é—´ï¼‰

```bash
# ç¬¬ä¸€æ‰¹: é«˜ä¼˜å…ˆçº§ï¼ˆ1,2,6,7,8ï¼‰
python run_batch_experiments.py --mode full --high-priority --suite-id batch1

# ç¬¬äºŒæ‰¹: å…¶ä»–å®éªŒï¼ˆ3,4,5ï¼‰
python run_batch_experiments.py --mode full --experiments 3,4,5 --suite-id batch2
```

### 4. ç›‘æ§è¿›åº¦

```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„Pythonè¿›ç¨‹
ps aux | grep run_batch_experiments

# æŸ¥çœ‹GPUä½¿ç”¨
nvidia-smi

# æŸ¥çœ‹ç”Ÿæˆçš„ç»“æœ
ls -lh results/parameter_sensitivity/
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æŸä¸ªå®éªŒå¤±è´¥

**æŸ¥çœ‹æ‰¹é‡æ‘˜è¦**:
```bash
cat results/parameter_sensitivity/batch_*_batch_summary.json
```

**æ‰‹åŠ¨é‡è·‘å¤±è´¥çš„å®éªŒ**:
```bash
python experiments/camtd3_strategy_suite/run_data_size_comparison.py \
    --episodes 100 --seed 42
```

### é—®é¢˜2: å¹¶è¡Œè¿è¡ŒGPUæ˜¾å­˜ä¸è¶³

**è§£å†³**: å‡å°‘å¹¶è¡Œæ•°
```bash
# ä» --parallel 3 æ”¹ä¸º --parallel 2
python run_batch_experiments.py --mode medium --all --parallel 2
```

### é—®é¢˜3: è¿è¡Œæ—¶é—´è¿‡é•¿

**è§£å†³**: å…ˆç”¨quickæ¨¡å¼æµ‹è¯•
```bash
# å¿«é€Ÿæ¨¡å¼ä»…10è½®
python run_batch_experiments.py --mode quick --all
```

---

## ğŸ“¦ è¾“å‡ºæ–‡ä»¶

### ç›®å½•ç»“æ„

```
results/parameter_sensitivity/
â”œâ”€â”€ batch_medium_20231029_123456_batch_summary.json    # æ‰¹é‡è¿è¡Œæ€»æ‘˜è¦
â”œâ”€â”€ batch_medium_20231029_123456_1_æ•°æ®å¤§å°å¯¹æ¯”/
â”‚   â”œâ”€â”€ summary.json
â”‚   â”œâ”€â”€ data_*.json
â”‚   â””â”€â”€ data_size_vs_*.png
â”œâ”€â”€ batch_medium_20231029_123456_2_è½¦è¾†æ•°é‡å¯¹æ¯”/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

### æ‰¹é‡æ‘˜è¦JSONæ ¼å¼

```json
{
  "suite_id": "batch_medium_20231029_123456",
  "mode": "medium",
  "episodes": 100,
  "total_experiments": 5,
  "successful": 5,
  "failed": 0,
  "total_time_seconds": 29640.5,
  "results": [
    {
      "exp_id": 1,
      "name": "æ•°æ®å¤§å°å¯¹æ¯”",
      "success": true,
      "elapsed_time": 5718.3,
      ...
    },
    ...
  ],
  "timestamp": "2023-10-29T12:34:56"
}
```

---

## âœ… æ£€æŸ¥æ¸…å•

ä½¿ç”¨æ‰¹é‡å·¥å…·å‰ï¼š
- [ ] ç¡®è®¤åœ¨é¡¹ç›®æ ¹ç›®å½• `D:\VEC_mig_caching`
- [ ] ç¡®è®¤condaç¯å¢ƒå·²æ¿€æ´»
- [ ] ç¡®è®¤æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ï¼ˆå»ºè®®â‰¥10GBï¼‰
- [ ] ç¡®è®¤GPUå¯ç”¨ï¼ˆå¦‚ä½¿ç”¨å¹¶è¡Œï¼‰

è¿è¡Œè¿‡ç¨‹ä¸­ï¼š
- [ ] ç›‘æ§GPUä½¿ç”¨ç‡
- [ ] å®šæœŸæ£€æŸ¥ç»“æœç›®å½•
- [ ] æ³¨æ„é”™è¯¯ä¿¡æ¯

è¿è¡Œå®Œæˆåï¼š
- [ ] æŸ¥çœ‹æ‰¹é‡æ‘˜è¦JSON
- [ ] æ£€æŸ¥æ‰€æœ‰å›¾è¡¨æ˜¯å¦ç”Ÿæˆ
- [ ] éªŒè¯æ•°æ®å®Œæ•´æ€§

---

## ğŸ‰ å¼€å§‹ä½¿ç”¨

**æœ€ç®€å•çš„æ–¹å¼**:
```bash
python experiments/camtd3_strategy_suite/run_batch_experiments.py
```

æŒ‰ç…§èœå•æç¤ºæ“ä½œå³å¯ï¼ ğŸš€

