# 车联网边缘计算系统分析报告

本文档旨在全面分析车联网（VEC）边缘计算仿真平台的系统设计，包括其核心的马尔可夫决策过程（MDP）模型、任务处理流程以及关键的系统参数配置。

## 1. 系统概述

本系统模拟了一个由车辆、路边单元（RSU）和无人机（UAV）组成的车联网环境。系统中的智能体（车辆节点）需要学习最优的计算卸载策略，以最小化任务处理时延、能耗和数据丢失率。

## 2. 马尔可夫决策过程 (MDP) 模型

系统的决策核心基于多智能体强化学习，其MDP模型定义如下：

### 2.1. 状态空间 (State Space)

每个车辆智能体的状态由以下几部分组成，旨在为其决策提供全面的上下文信息：

*   **自身节点状态**:
    *   **平均队列填充度**: 自身计算任务队列的拥堵情况，使智能体能感知本地负载压力。
*   **邻近节点状态**:
    *   **RSU (路边单元) 状态**:
        *   与各RSU的连接状态（是否在通信范围内）。
        *   各RSU的队列填充度（负载情况）。
        *   与各RSU的预期传输速率。
    *   **UAV (无人机) 状态**:
        *   与各UAV的连接状态。
        *   各UAV的队列填充度。
        *   与各UAV的预期传输速率。
        *   各UAV的剩余电量。
*   **全局系统状态**:
    *   **归一化的历史性能指标**: 包括上一时间步的平均任务处理时延、总能耗、数据丢失率等。
    *   **节点数量**: 场景中各类节点的数量。

### 2.2. 动作空间 (Action Space)

每个时间步，智能体需要为新生成的任务选择一个执行节点。动作空间是一个离散集合，包含所有合法的候选计算节点：

*   **本地处理**: 在车辆自身节点上执行。
*   **卸载到RSU**: 发送到通信范围内的某个RSU处理。
*   **卸载到UAV**: 发送到通信范围内的某个UAV处理。
*   **卸载到其他车辆**: 发送到附近的某个其他车辆处理。

### 2.3. 奖励函数 (Reward Function)

奖励函数旨在引导智能体实现最小化系统综合成本的最终目标。该目标函数定义为：

`Cost = ω_T * Delay + ω_E * Energy + ω_D * Loss`

其中 `ω_T, ω_E, ω_D` 分别是时延、能耗和任务丢失率的权重。

为了在强化学习框架下进行优化（最大化累计奖励），奖励函数被设定为**成本的负数**：

`Reward = -Cost`

这种设计激励智能体采取能够降低系统总体成本的行动。

## 3. 任务处理流程

任务从生成到完成的生命周期如下：

1.  **任务生成**: 在每个仿真时间步（time slot）开始时，系统会根据预设的任务生成率，为每个车辆节点生成新的计算任务。这些任务具有不同的类型（Type 1-4）、数据量和计算需求。
2.  **智能体决策**: 新生成的任务首先进入车辆节点的本地队列。车辆智能体（Agent）根据其当前状态（包括自身队列拥堵情况、邻近RSU/UAV/其他车辆的连接状态和负载等）以及MDP模型，为每个任务做出卸载决策。
    *   **本地处理**: 任务在车辆自身CPU上执行。
    *   **卸载到边缘节点**: 任务通过无线通信传输到RSU或UAV进行处理。
    *   **卸载到其他车辆**: 任务通过V2V通信传输到其他车辆进行处理。
3.  **任务传输**: 如果任务被卸载，它将通过无线信道传输到目标计算节点。传输过程中会产生时延和能耗，并可能因信道质量不佳或节点移动而导致数据丢失。
4.  **任务排队**: 任务到达目标计算节点后，会进入该节点的任务队列等待处理。队列的长度和任务的优先级会影响任务的等待时间。
5.  **任务执行**: 计算节点（车辆、RSU、UAV）根据其CPU频率和并行处理能力执行任务。任务执行会消耗计算资源和能量。
6.  **结果返回**: 任务处理完成后，结果会返回给发起任务的车辆节点。这个过程同样涉及传输时延和能耗。
7.  **任务完成与统计**: 任务结果成功返回后，被标记为完成。系统会收集任务的时延、能耗、数据丢失等指标，用于计算奖励和评估系统性能。
8.  **任务丢失**: 如果任务在传输过程中丢失、或在队列中等待时间过长（超时）、或因节点移动超出通信范围等原因未能成功处理，则被视为任务丢失。

整个流程在一个离散的时间步长（time slot）内循环进行，智能体在每个时间步根据当前系统状态做出决策，并观察环境反馈（奖励和下一状态）。

## 4. 关键参数设置

系统的行为由 `config/system_config.py` 文件中的参数控制。以下是核心配置的摘要：

### 4.1. 网络与环境配置 (`NetworkConfig`)

*   **仿真时长**: 300个时间步 (slots)
*   **时间步长**: 0.3 秒
*   **节点数量**: 
    *   车辆: 12
    *   RSU: 6
    *   UAV: 2
*   **通信范围**:
    *   V2V (车-车): 300 米
    *   V2I (车-基础设施): 500 米
    *   V2U (车-无人机): 动态变化
*   **信道带宽**: 20 MHz

### 4.2. 节点计算能力 (`ComputeConfig`)

*   **车辆 (Vehicle)**: 
    *   CPU频率: 15-35 G cycles/秒 (异构)
    *   并行处理效率: 0.8
*   **路边单元 (RSU)**:
    *   CPU频率: 80 G cycles/秒
    *   并行处理效率: 0.95
*   **无人机 (UAV)**:
    *   CPU频率: 15 G cycles/秒
    *   并行处理效率: 0.7

### 4.3. 任务属性配置 (`TaskConfig`)

*   **任务到达率**: 泊松分布, 均值 2.5 tasks/slot
*   **任务数据量**: 均匀分布, 1-20 Mbits
*   **计算密度**: 类型1-4分别为 60/90/120/150 cycles/bit
*   **任务截止时间**: 1.0 秒
*   **任务类型分布**: Type 1 (40%), Type 2 (30%), Type 3 (20%), Type 4 (10%)

### 4.4. 队列与能耗配置 (`QueueConfig`, `EnergyConfig`)

*   **队列容量**: 
    *   车辆: 50 个任务
    *   RSU: 200 个任务
    *   UAV: 30 个任务
*   **能耗模型**:
    *   车辆CPU (处理): 1.5-2.5 W
    *   RSU CPU (处理): 20 W
    *   UAV CPU (处理): 5 W
    *   传输功耗: 0.2-0.5 W (取决于信道)
    *   UAV飞行功耗: 100 W

### 4.5. 强化学习与奖励配置 (`RLConfig`, `RewardConfig`)

*   **奖励权重**:
    *   时延 (`ω_T`): 0.4
    *   能耗 (`ω_E`): 0.3
    *   数据丢失 (`ω_D`): 0.3
*   **奖励归一化基准**:
    *   时延: 0.5 秒
    *   能耗: 500 焦耳
*   **MATD3算法主要参数**:
    *   学习率 (Actor/Critic): 1e-4 / 2e-4
    *   折扣因子 (Gamma): 0.99
    *   软更新系数 (Tau): 0.01
    *   缓冲区大小: 100,000
