# =============================================================================
# VECè¾¹ç¼˜è®¡ç®—ç³»ç»Ÿ - ç»Ÿä¸€é»˜è®¤é…ç½®
# å‚è€ƒXuanceæ¡†æ¶é£æ ¼è®¾è®¡
#
# ä½¿ç”¨æ–¹å¼ï¼š
#   python train_single_agent.py --config config/defaults.yaml
#   python train_single_agent.py --config config/my_experiment.yaml
#
# ä¼˜å…ˆçº§ï¼šç¯å¢ƒå˜é‡ > å‘½ä»¤è¡Œå‚æ•° > YAMLé…ç½® > Pythoné»˜è®¤å€¼
# =============================================================================

# é…ç½®å…ƒä¿¡æ¯
config_version: "2.0"
config_source: "defaults.yaml"

# -----------------------------------------------------------------------------
# ç½‘ç»œæ‹“æ‰‘é…ç½®
# -----------------------------------------------------------------------------
network:
  num_vehicles: 12 # è½¦è¾†æ•°é‡
  num_rsus: 4 # RSUæ•°é‡
  num_uavs: 2 # UAVæ•°é‡
  area_width: 1030.0 # åŒºåŸŸå®½åº¦ (m)
  area_height: 2060.0 # åŒºåŸŸé«˜åº¦ (m)
  coverage_radius: 300.0 # RSUè¦†ç›–åŠå¾„ (m)
  uav_coverage_radius: 500.0 # UAVè¦†ç›–åŠå¾„ (m)
  uav_altitude: 100.0 # UAVé£è¡Œé«˜åº¦ (m)

# -----------------------------------------------------------------------------
# é€šä¿¡å‚æ•°é…ç½® (3GPPæ ‡å‡†)
# -----------------------------------------------------------------------------
communication:
  bandwidth: 40.0e6 # æ€»å¸¦å®½ 40 MHz
  carrier_frequency: 3.5e9 # è½½æ³¢é¢‘ç‡ 3.5 GHz (NR n78é¢‘æ®µ)
  noise_power: -100.0 # å™ªå£°åŠŸç‡ (dBm)
  path_loss_exponent: 3.0 # è·¯å¾„æŸè€—æŒ‡æ•°

  # å‘å°„åŠŸç‡ (dBm)
  vehicle_tx_power: 30.0 # è½¦è¾† 1W = 30 dBm
  rsu_tx_power: 40.0 # RSU 10W = 40 dBm
  uav_tx_power: 23.0 # UAV 0.2W = 23 dBm

  # å¤©çº¿å¢ç›Š (dBi)
  antenna_gain_rsu: 15.0
  antenna_gain_uav: 5.0
  antenna_gain_vehicle: 3.0

  # é®æŒ¡æ¨¡å‹
  enable_blockage: true
  building_density: 0.3 # å»ºç­‘å¯†åº¦ (0=éƒŠåŒº, 0.5=åŸå¸‚, 1.0=å¯†é›†åŸåŒº)

  # ç¼–ç æ•ˆç‡
  coding_efficiency: 0.9 # 5G NRç¼–ç æ•ˆç‡

# -----------------------------------------------------------------------------
# è®¡ç®—èµ„æºé…ç½®
# -----------------------------------------------------------------------------
compute:
  # æ€»è®¡ç®—èµ„æºæ±  (Hz)
  total_vehicle_compute: 18.0e9 # 18 GHz (12è½¦è¾†å…±äº«)
  total_rsu_compute: 50.0e9 # 50 GHz (4ä¸ªRSUå…±äº«)
  total_uav_compute: 14.0e9 # 14 GHz (2ä¸ªUAVå…±äº«)

  # CPUé¢‘ç‡èŒƒå›´ (Hz)
  vehicle_cpu_freq_min: 1.0e9
  vehicle_cpu_freq_max: 2.0e9
  rsu_cpu_freq: 12.5e9
  uav_cpu_freq_min: 6.0e9
  uav_cpu_freq_max: 8.0e9

  # èƒ½è€—å‚æ•°
  vehicle_kappa: 1.5e-28 # è½¦è¾†åŠŸè€—ç³»æ•°
  rsu_kappa: 5.0e-32 # RSUåŠŸè€—ç³»æ•°
  uav_kappa: 8.89e-31 # UAVåŠŸè€—ç³»æ•°
  vehicle_static_power: 5.0 # è½¦è¾†é™æ€åŠŸè€— (W)
  rsu_static_power: 25.0 # RSUé™æ€åŠŸè€— (W)
  uav_static_power: 2.5 # UAVé™æ€åŠŸè€— (W)
  uav_hover_power: 15.0 # UAVæ‚¬åœåŠŸè€— (W)

  parallel_efficiency: 0.8 # å¹¶è¡Œå¤„ç†æ•ˆç‡

# -----------------------------------------------------------------------------
# ä»»åŠ¡ç”Ÿæˆé…ç½®
# -----------------------------------------------------------------------------
task:
  arrival_rate: 3.5 # ä»»åŠ¡åˆ°è¾¾ç‡ (tasks/s)
  data_size_min: 5.0e6 # æœ€å°æ•°æ®é‡ 5 MB
  data_size_max: 10.0e6 # æœ€å¤§æ•°æ®é‡ 10 MB
  compute_density: 2.5 # è®¡ç®—å¯†åº¦ (cycles/bit)
  compute_cycles_min: 1.0e8 # æœ€å°è®¡ç®—å‘¨æœŸ
  compute_cycles_max: 5.0e9 # æœ€å¤§è®¡ç®—å‘¨æœŸ
  deadline_min: 1.0 # æœ€å°æˆªæ­¢æ—¶é—´ (s)
  deadline_max: 6.5 # æœ€å¤§æˆªæ­¢æ—¶é—´ (s)
  output_ratio: 0.05 # è¾“å‡º/è¾“å…¥æ¯”ä¾‹

# -----------------------------------------------------------------------------
# é˜Ÿåˆ—ç®¡ç†é…ç½®
# -----------------------------------------------------------------------------
queue:
  max_lifetime: 10 # æœ€å¤§ç”Ÿå‘½å‘¨æœŸ (æ—¶éš™æ•°)
  max_queue_size: 100 # é˜Ÿåˆ—æœ€å¤§å®¹é‡
  priority_levels: 4 # ä¼˜å…ˆçº§çº§åˆ«
  aging_factor: 0.25 # è€åŒ–å› å­
  max_load_factor: 1.5 # æœ€å¤§è´Ÿè½½å› å­

  rsu_nominal_capacity: 50.0
  uav_nominal_capacity: 30.0
  vehicle_nominal_capacity: 20.0

# -----------------------------------------------------------------------------
# ä»»åŠ¡è¿ç§»é…ç½®
# -----------------------------------------------------------------------------
migration:
  migration_bandwidth: 100.0e6 # è¿ç§»å¸¦å®½ (bps)
  migration_threshold: 0.8 # è¿ç§»é˜ˆå€¼
  rsu_overload_threshold: 0.70 # RSUè¿‡è½½é˜ˆå€¼
  uav_overload_threshold: 0.70 # UAVè¿‡è½½é˜ˆå€¼
  cooldown_period: 0.5 # å†·å´æœŸ (s)
  max_migration_distance: 1000.0 # æœ€å¤§è¿ç§»è·ç¦» (m)

# -----------------------------------------------------------------------------
# ç¼“å­˜é…ç½®
# -----------------------------------------------------------------------------
cache:
  vehicle_cache_capacity: 100.0e6 # è½¦è¾†ç¼“å­˜ 100 MB
  rsu_cache_capacity: 200.0e6 # RSUç¼“å­˜ 200 MB
  uav_cache_capacity: 150.0e6 # UAVç¼“å­˜ 150 MB
  cache_replacement_policy: "HYBRID"
  cache_hit_threshold: 0.8
  enable_predictive_caching: true

# -----------------------------------------------------------------------------
# æœåŠ¡èƒ½åŠ›é…ç½® (ğŸ†•)
# -----------------------------------------------------------------------------
service:
  # RSUæœåŠ¡èƒ½åŠ›
  rsu_base_service: 10
  rsu_max_service: 25
  rsu_work_capacity: 6.0
  rsu_queue_boost_divisor: 4.0

  # UAVæœåŠ¡èƒ½åŠ›
  uav_base_service: 8
  uav_max_service: 16
  uav_work_capacity: 4.5
  uav_queue_boost_divisor: 2.0

# -----------------------------------------------------------------------------
# å½’ä¸€åŒ–é…ç½® (ğŸ†•)
# -----------------------------------------------------------------------------
normalization:
  # æ•°å€¼ç¨³å®š
  metric_epsilon: 1.0e-6

  # ä½ç½®/é€Ÿåº¦å°ºåº¦
  vehicle_position_range: 2060.0
  rsu_position_range: 2060.0
  uav_position_range: 2060.0
  uav_altitude_range: 200.0
  vehicle_speed_range: 50.0

  # é˜Ÿåˆ—å®¹é‡
  vehicle_queue_capacity: 20.0
  rsu_queue_capacity: 20.0
  uav_queue_capacity: 20.0

  # èƒ½è€—å‚è€ƒ
  vehicle_energy_reference: 1000.0
  rsu_energy_reference: 1000.0
  uav_energy_reference: 1000.0

  # å…¨å±€æ€§èƒ½å‚è€ƒ
  delay_reference: 4.0
  delay_upper_reference: 6.5
  energy_reference: 500.0
  energy_upper_reference: 800.0

# -----------------------------------------------------------------------------
# TD3ç®—æ³•é…ç½® (æ ¸å¿ƒï¼)
# -----------------------------------------------------------------------------
td3:
  # ç½‘ç»œç»“æ„
  hidden_dim: 256
  graph_embed_dim: 128

  # å­¦ä¹ ç‡
  actor_lr: 9.0e-5
  critic_lr: 9.0e-5

  # è®­ç»ƒå‚æ•°
  batch_size: 384
  buffer_size: 100000
  warmup_steps: 1000

  # TD3ç‰¹æœ‰å‚æ•°
  gamma: 0.99 # æŠ˜æ‰£å› å­
  tau: 0.005 # è½¯æ›´æ–°ç³»æ•°
  policy_delay: 2 # ç­–ç•¥å»¶è¿Ÿæ›´æ–°

  # æ¢ç´¢å‚æ•°
  exploration_noise: 0.18 # åˆå§‹æ¢ç´¢å™ªå£°
  noise_decay: 0.9996 # å™ªå£°è¡°å‡ç‡
  min_noise: 0.05 # æœ€å°å™ªå£°
  target_noise: 0.05 # ç›®æ ‡ç­–ç•¥å¹³æ»‘å™ªå£°
  noise_clip: 0.2 # å™ªå£°è£å‰ªèŒƒå›´

  # æ­£åˆ™åŒ–
  gradient_clip_norm: 0.5 # æ¢¯åº¦è£å‰ª
  use_gradient_clip: true
  cql_alpha: 0.12 # CQLæ­£åˆ™å¼ºåº¦

  # æ³¨æ„åŠ›æœºåˆ¶
  use_actor_attention: true
  use_critic_attention: true
  attention_min_gate: 0.6

# -----------------------------------------------------------------------------
# å¥–åŠ±å‡½æ•°é…ç½®
# -----------------------------------------------------------------------------
reward:
  # æƒé‡ (å»¶è¿Ÿ+èƒ½è€—ç­‰æƒé‡)
  weight_delay: 0.5
  weight_energy: 0.5
  penalty_dropped: 1.0
  weight_completion_gap: 1.0
  weight_loss_ratio: 1.0

  # min-maxå½’ä¸€åŒ–èŒƒå›´
  latency_min: 0.05 # æœ€ä¼˜å»¶è¿Ÿ (s)
  latency_target: 0.3 # ç›®æ ‡å»¶è¿Ÿ (s)
  latency_max: 2.0 # æœ€å·®å»¶è¿Ÿ (s)
  energy_min: 1000.0 # æœ€ä¼˜èƒ½è€— (J)
  energy_target: 10000.0 # ç›®æ ‡èƒ½è€— (J)
  energy_max: 25000.0 # æœ€å·®èƒ½è€— (J)

  use_dynamic_normalization: false
  reward_scale: 1.0

# -----------------------------------------------------------------------------
# å®éªŒé…ç½®
# -----------------------------------------------------------------------------
experiment:
  num_episodes: 1000 # è®­ç»ƒè½®æ¬¡
  max_steps_per_episode: 200
  eval_interval: 50
  save_interval: 100
  log_interval: 20
  warmup_episodes: 10
  num_runs: 3
  random_seed: 42

# -----------------------------------------------------------------------------
# ç³»ç»Ÿé…ç½®
# -----------------------------------------------------------------------------
system:
  device: "auto" # auto, cpu, cuda
  num_threads: 4
  time_slot_duration: 1.0 # æ—¶éš™é•¿åº¦ (s)
  simulation_time: 1000
  enable_performance_optimization: true
